<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <title>FunPlotter</title>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
  crossorigin="anonymous">
  <link rel="stylesheet" href="/static/styles.css">
</head>

<body>
  <header>
    <nav id="header__nav" class="navbar">
      <div class="container-fluid">
        <h1 class="navbar-brand">FunPlotter</h1>
        <span class="navbar-text">Univariate function plots</span>
      </div>
    </nav>
  </header>

  <main>
    <div class="fn-list" id="fn-list">

      {% for function, edit_form in functions | zip(edit_forms) %}
        <form class="row row-cols-sm-auto g-1 align-items-center" action="{{ url_for('index') }}" method="post" novalidate>
          {{ edit_form.hidden_tag() }}
          <div class="col-12 col-sm-4">
            <div class="input-group input-group-sm">
              {{ edit_form.function.label(class_="input-group-text") }}
              {% if edit_form.function.errors %}
                {{ edit_form.function(value=function['label'], class_="form-control form-control-sm is-invalid") }}
                <div class="invalid-feedback">
                  {% for error in edit_form.function.errors %}
                    {{ error }}
                    Reverted to original.
                  {% endfor %}
                </div>
              {% else %}
                {{ edit_form.function(value=function['label'], class_="form-control form-control-sm") }}
              {% endif %}
            </div>
          </div>

          <div class="col-6 col-sm-2">
            <div class="input-group input-group-sm col-6">
              {{ edit_form.xMin.label(class_="input-group-text") }}
              {% if edit_form.xMin.errors %}
                {{ edit_form.xMin(value=function['x_min'], class_="form-control form-control-sm is-invalid") }}
                <div class="invalid-feedback">
                  {% for error in edit_form.xMin.errors %}
                    {{ error }}
                    Reverted to original.
                  {% endfor %}
                </div>
              {% else %}
                {{ edit_form.xMin(value=function['x_min'], class_="form-control form-control-sm") }}
              {% endif %}
            </div>
          </div>

          <div class="col-6 col-sm-2">
            <div class="input-group input-group-sm">
              {{ edit_form.xMax.label(class_="input-group-text") }}
              {% if edit_form.xMax.errors %}
                {{ edit_form.xMax(value=function['x_max'], class_="form-control form-control-sm is-invalid") }}
                <div class="invalid-feedback">
                  {% for error in edit_form.xMax.errors %}
                    {{ error }}
                    Reverted to original.
                  {% endfor %}
                </div>
              {% else %}
                {{ edit_form.xMax(value=function['x_max'], class_="form-control form-control-sm") }}
              {% endif %}
            </div>
          </div>

          <div class="col-12 col-sm-4">
            {{ edit_form.update(class_="btn btn-outline-primary btn-sm") }}
            {{ edit_form.delete(class_="btn btn-outline-danger btn-sm") }}
          </div>
        </form>

      {% endfor %}
    </div>

    <div class="fn-add" id="fn-add">
      <form class="row row-cols-sm-auto g-1 align-items-center" id="fn-form" action="{{ url_for('index') }}" method="post" novalidate>
        {{ add_form.hidden_tag() }}

        <div class="col-12 col-sm-4">
          <div class="input-group input-group-sm">
            {{ add_form.function.label(class_="input-group-text") }}
            {% if add_form.function.errors %}
              {{ add_form.function(class_="form-control form-control-sm is-invalid") }}
              <div class="invalid-feedback form-check">
                {% for error in add_form.function.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ add_form.function(class_="form-control form-control-sm") }}
            {% endif %}
          </div>
        </div>

        <div class="col-6 col-sm-2">
          <div class="input-group input-group-sm">
            {{ add_form.xMin.label(class_="input-group-text") }}
            {% if add_form.xMin.errors %}
              {{ add_form.xMin(class_="form-control form-control-sm is-invalid") }}
              <div class="invalid-feedback form-check">
                {% for error in add_form.xMin.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ add_form.xMin(class_="form-control form-control-sm") }}
            {% endif %}
          </div>
        </div>

        <div class="col-6 col-sm-2">
          <div class="input-group input-group-sm">
            {{ add_form.xMax.label(class_="input-group-text") }}
            {% if add_form.xMax.errors %}
              {{ add_form.xMax(class_="form-control form-control-sm is-invalid") }}
              <div class="invalid-feedback form-check">
                {% for error in add_form.xMax.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ add_form.xMax(class_="form-control form-control-sm") }}
            {% endif %}
          </div>
        </div>

        <div class="col-12 col-sm-4">
          <div class="fn-form__buttons">
            {{ add_form.submit(class_="btn btn-outline-success btn-sm") }}
          </div>
        </div>
      </form>
    </div>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <ul class=flashes>
      {% for message in messages %}
      <li>{{ message }}</li>
      {% endfor %}
    </ul>
    {% endif %}
    {% endwith %}

    <canvas id="funPlots"></canvas>

    <script>
      const ctx = document.getElementById('funPlots').getContext('2d');
      const dataSets = {{ functions | tojson }};
      const lineChart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: dataSets,
        },
        options: {
          elements: {
            point: {
              pointStyle: false
            }
          },
          scales: {
            x: {
              type: 'linear',
              position: 'bottom',
              title: {
                display: true,
                text: 'x'
              }
            },
            y: {
              type: 'linear',
              position: 'left',
              title: {
                display: true,
                text: 'f(x)'
              }
            }
          }
        }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous">
    </script>

  </main>

  <footer>

  </footer>
</body>
  Made by af0liveira
</html>